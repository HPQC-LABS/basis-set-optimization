created virtual environment CPython3.10.2.final.0-64 in 4075ms
  creator CPython3Posix(dest=/localscratch/nike.35632132.0/ENV, clear=True, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/nike/.local/share/virtualenv)
    added seed packages: pip==22.3.1, setuptools==67.3.3, wheel==0.38.4+computecanada
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx512, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /localscratch/nike.35632132.0/ENV/lib/python3.10/site-packages (22.3.1)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pip-23.0+computecanada-py3-none-any.whl
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 22.3.1
    Uninstalling pip-22.3.1:
      Successfully uninstalled pip-22.3.1
Successfully installed pip-23.0+computecanada
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx512, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /home/nike/pyscf_ad/dist/pyscf-2.1.1+ad-cp310-cp310-linux_x86_64.whl
Processing /home/nike/properties_ad/dist/pyscf_properties-0.1.0+ad-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/absl_py-1.4.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic/contourpy-1.0.7+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/cycler-0.11.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/fonttools-4.39.0+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/h5py-3.8.0+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jax-0.4.2+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic/jaxlib-0.4.2+cuda11.cudnn82.computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jaxopt-0.6+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/kiwisolver-1.4.4+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/matplotlib-3.7.0+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic/numpy-1.24.2+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/opt_einsum-3.3.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/packaging-23.0+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2/Pillow-9.4.0+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyparsing-3.0.9+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pyscfad-0.1.2+computecanada-py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/python_dateutil-2.8.2+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic/scipy-1.10.1+computecanada-cp310-cp310-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/six-1.16.0+computecanada-py2.py3-none-any.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/typing_extensions-4.5.0+computecanada-py3-none-any.whl
Installing collected packages: typing_extensions, six, pyparsing, Pillow, packaging, numpy, kiwisolver, fonttools, cycler, absl_py, scipy, python-dateutil, opt-einsum, h5py, contourpy, pyscf, matplotlib, jaxlib, pyscf-properties, jax, jaxopt, pyscfad
Successfully installed Pillow-9.4.0+computecanada absl_py-1.4.0+computecanada contourpy-1.0.7+computecanada cycler-0.11.0+computecanada fonttools-4.39.0+computecanada h5py-3.8.0+computecanada jax-0.4.2+computecanada jaxlib-0.4.2+cuda11.cudnn82.computecanada jaxopt-0.6+computecanada kiwisolver-1.4.4+computecanada matplotlib-3.7.0+computecanada numpy-1.24.2+computecanada opt-einsum-3.3.0+computecanada packaging-23.0+computecanada pyparsing-3.0.9+computecanada pyscf-2.1.1+ad pyscf-properties-0.1.0+ad pyscfad-0.1.2+computecanada python-dateutil-2.8.2+computecanada scipy-1.10.1+computecanada six-1.16.0+computecanada typing_extensions-4.5.0+computecanada
#INFO: **** input file is /home/nike/basis-set-optimization/018_Ar/input.py ****
#!/usr/bin/env python

import pyscf
from pyscfad import gto, scf
import numpy as np
import re

from scipy import optimize

VERBOSITY = 9

def parse_basis_str(slug):
    numbers_and_letters = re.findall(r'[A-Za-z]+|\d+', slug)
    numbers_with_letters = [
        [int(numbers_and_letters[i]), numbers_and_letters[i+1].capitalize()]
        for i in range(0, len(numbers_and_letters), 2)
    ]
    return numbers_with_letters

def decaying_nums(n):
    return np.array([0.5 * (n - i) for i in range(n)])

def get_basis_substring(exponent, orbital):
    substring = f'''
    Ar  {orbital}
        {exponent}              1.0'''
    return substring

def get_basis_string(basis_str, exponents, exp_array=None):
    basis_set = parse_basis_str(basis_str)
    basis_nums = [num for [num, _] in basis_set]
    basis_cum_nums = np.cumsum(basis_nums)

    if exp_array is None:
        exp_array = np.zeros((exponents.size, 2))

    exp_array[np.where(exp_array[:, 1] == 0), 0] = exponents[np.where(exp_array[:, 1] == 0)]

    basis_string = ''.join([''.join([
        get_basis_substring(exp_array[i, 0], orbital) if j == 0 else
        get_basis_substring(exp_array[i + basis_cum_nums[j-1], 0], orbital)
        for i in range(num)
    ]) for j, [num, orbital] in enumerate(basis_set)])

    return basis_string

def atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}

    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    e = mf.kernel()

    print(f"exp = {exponents}")
    print(f"E = {e}")

    return e

def grad_atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}
    
    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    mf.kernel()
    jac = mf.energy_grad()

    print(f"exp = {exponents}")
    print(f"grad_E = {jac.exp}")

    grad_E = np.array(jac.exp)

    return grad_E

def minimize_energy(basis_str, exp_array=None):
    x0 = exp_array[:, 0]
    bnds = ((1e-9, None) for _ in range(exp_array.shape[0]))

    res = optimize.minimize(
        atomic_energy,
        x0,
        args=(basis_str, exp_array),
        method="SLSQP",
        jac=grad_atomic_energy,
        hess=None,
        hessp=None,
        bounds=bnds,
        tol=1e-9,
        callback=None,
        options={"maxfev": 10000, "ftol": 1e-9},
    )
    
    print(res)
    print(f"E = {atomic_energy(res.x, basis_str)}")
    print(f"exp = [{','.join(['{:.16e}'.format(x) for x in res.x])}]")
    
exps = np.zeros((15, 2))
#exps[:, 0] = decaying_nums(5)
exps_old = np.array([2.9404203565162310e+05,1.4702101782581155e+05,7.3510507976032939e+04,3.6755234472949749e+04,7.3318021734695621e+03,1.8377161218510078e+04,1.2389777727143498e+03,2.9819001594010280e+02,8.8430468748019706e+01,3.0676681173089506e+01,4.6834518331880934e+00,3.9101606979807535e-01,8.5988787479386612e+00,4.9105109461223539e-01])
exps[1:, 0] = exps_old[:]
exps[0, 0] = np.max(exps_old) * 2

basis = "13s2p"

minimize_energy(basis, exps)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='bc11219.int.ets1.calculquebec.ca', release='3.10.0-1160.76.1.el7.x86_64', version='#1 SMP Wed Aug 10 16:21:17 UTC 2022', machine='x86_64')  Threads 16
Python 3.10.2 (main, Feb  4 2022, 19:11:32) [GCC 9.3.0]
numpy 1.24.2  scipy 1.10.1
Date: Fri Mar 17 01:10:12 2023
PySCF version 2.1.1+ad
PySCF path  /localscratch/nike.35632132.0/ENV/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 16000
[ENV] PYSCF_CONFIG_FILE /home/nike/.pyscfad_conf.py
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 16000
[CONFIG] TMPDIR = /tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = /home/nike/.pyscfad_conf.py
[CONFIG] pyscf_numpy_backend = jax
[CONFIG] pyscf_scipy_backend = jax
[CONFIG] pyscf_scipy_linalg_backend = pyscfad
[CONFIG] pyscfad = True
[CONFIG] pyscfad_ccsd_implicit_diff = True
[CONFIG] pyscfad_scf_implicit_diff = True
[INPUT] verbose = 9
[INPUT] max_memory = 16000 
[INPUT] num. atoms = 1
[INPUT] num. electrons = 18
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ar     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Ar
[INPUT] 0    0    [1    /1   ]  588084.071303        1
[INPUT] 0    0    [1    /1   ]  294042.035652        1
[INPUT] 0    0    [1    /1   ]  147021.017826        1
[INPUT] 0    0    [1    /1   ]  73510.507976         1
[INPUT] 0    0    [1    /1   ]  36755.2344729        1
[INPUT] 0    0    [1    /1   ]  7331.80217347        1
[INPUT] 0    0    [1    /1   ]  18377.1612185        1
[INPUT] 0    0    [1    /1   ]  1238.97777271        1
[INPUT] 0    0    [1    /1   ]  298.19001594         1
[INPUT] 0    0    [1    /1   ]  88.430468748         1
[INPUT] 0    0    [1    /1   ]  30.6766811731        1
[INPUT] 0    0    [1    /1   ]  4.68345183319        1
[INPUT] 0    0    [1    /1   ]  0.391016069798       1
[INPUT] 1    0    [1    /1   ]  8.59887874794        1
[INPUT] 1    0    [1    /1   ]  0.491051094612       1

nuclear repulsion = 0
number of shells = 15
number of NR pGTOs = 19
number of NR cGTOs = 19
basis = {'Ar': [[0, [588084.0713032462, 1.0]], [0, [294042.0356516231, 1.0]], [0, [147021.01782581155, 1.0]], [0, [73510.50797603294, 1.0]], [0, [36755.23447294975, 1.0]], [0, [7331.802173469562, 1.0]], [0, [18377.16121851008, 1.0]], [0, [1238.9777727143498, 1.0]], [0, [298.1900159401028, 1.0]], [0, [88.4304687480197, 1.0]], [0, [30.676681173089506, 1.0]], [0, [4.683451833188093, 1.0]], [0, [0.39101606979807535, 1.0]], [1, [8.598878747938661, 1.0]], [1, [0.4910510946122354, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [588084.07130325]
bas 1, expnt(s) = [294042.03565162]
bas 2, expnt(s) = [147021.01782581]
bas 3, expnt(s) = [73510.50797603]
bas 4, expnt(s) = [36755.23447295]
bas 5, expnt(s) = [7331.80217347]
bas 6, expnt(s) = [18377.16121851]
bas 7, expnt(s) = [1238.97777271]
bas 8, expnt(s) = [298.19001594]
bas 9, expnt(s) = [88.43046875]
bas 10, expnt(s) = [30.67668117]
bas 11, expnt(s) = [4.68345183]
bas 12, expnt(s) = [0.39101607]
bas 13, expnt(s) = [8.59887875]
bas 14, expnt(s) = [0.49105109]
CPU time:         1.43
arg.atm = [[18 20  1 23  0  0]]
arg.bas = [[ 0  0  1  1  0 24 25  0]
 [ 0  0  1  1  0 26 27  0]
 [ 0  0  1  1  0 28 29  0]
 [ 0  0  1  1  0 30 31  0]
 [ 0  0  1  1  0 32 33  0]
 [ 0  0  1  1  0 34 35  0]
 [ 0  0  1  1  0 36 37  0]
 [ 0  0  1  1  0 38 39  0]
 [ 0  0  1  1  0 40 41  0]
 [ 0  0  1  1  0 42 43  0]
 [ 0  0  1  1  0 44 45  0]
 [ 0  0  1  1  0 46 47  0]
 [ 0  0  1  1  0 48 49  0]
 [ 0  1  1  1  0 50 51  0]
 [ 0  1  1  1  0 52 53  0]]
arg.env = [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.88084071e+05 5.36530712e+04 2.94042036e+05 3.19023070e+04
 1.47021018e+05 1.89692252e+04 7.35105080e+04 1.12791687e+04
 3.67552345e+04 6.70663116e+03 7.33180217e+03 2.00181103e+03
 1.83771612e+04 3.98771253e+03 1.23897777e+03 5.27609565e+02
 2.98190016e+02 1.81294591e+02 8.84304687e+01 7.28561923e+01
 3.06766812e+01 3.29322424e+01 4.68345183e+00 8.04339817e+00
 3.91016070e-01 1.24928343e+00 8.59887875e+00 4.29572700e+01
 4.91051095e-01 1.19920311e+00]
ecpbas  = []
Set gradient conv threshold to 3.16228e-05
Nelec from initial guess = 17.320919029160578
cond(S) = 8085.819100894392
E1 = -689.0217762222677  E_coul = 184.8934120398981
init E= -504.12836418237
    CPU time for initialize scf      5.06 sec, wall time      0.98 sec
  HOMO = -0.680411666686959  LUMO = 57.8459835850426
  mo_energy =
[-1.21689152e+02 -1.32943546e+01 -7.62443087e+00 -7.62443087e+00
 -7.62443087e+00 -1.64988997e+00 -6.80411667e-01 -6.80411667e-01
 -6.80411667e-01  5.78459836e+01  4.33806932e+02  2.20187382e+03
  1.13910197e+04  4.10589449e+04  1.10240452e+05  2.56003966e+05
  5.57112002e+05  1.19531066e+06  2.66496276e+06]
E1 = -706.6827735694505  E_coul = 198.94970356062234
cycle= 1 E= -507.733070008828  delta_E= -3.6  |g|= 0.345  |ddm|= 0.303
    CPU time for cycle= 1      0.32 sec, wall time      0.32 sec
diis-norm(errvec)=0.542049
diis-c [-0.2938173  1.       ]
  HOMO = -0.236412214763474  LUMO = 59.135270164721
  mo_energy =
[-1.20288229e+02 -1.22661114e+01 -6.65476107e+00 -6.65476107e+00
 -6.65476107e+00 -1.16419130e+00 -2.36412215e-01 -2.36412215e-01
 -2.36412215e-01  5.91352702e+01  4.35195860e+02  2.20319376e+03
  1.13922070e+04  4.10600578e+04  1.10241525e+05  2.56005012e+05
  5.57113027e+05  1.19531167e+06  2.66496375e+06]
E1 = -706.6296307546448  E_coul = 198.89581034849672
cycle= 2 E= -507.733820406148  delta_E= -0.00075  |g|= 0.00634  |ddm|= 0.0255
    CPU time for cycle= 2      0.11 sec, wall time      0.11 sec
diis-norm(errvec)=0.00682465
diis-c [-4.59051705e-05  1.50864360e-03  9.98491356e-01]
  HOMO = -0.236747296045644  LUMO = 59.1305894149306
  mo_energy =
[-1.20301681e+02 -1.22683255e+01 -6.65813297e+00 -6.65813297e+00
 -6.65813297e+00 -1.16431687e+00 -2.36747296e-01 -2.36747296e-01
 -2.36747296e-01  5.91305894e+01  4.35181941e+02  2.20317316e+03
  1.13921817e+04  4.10600309e+04  1.10241497e+05  2.56004984e+05
  5.57112999e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6287009607181  E_coul = 198.894880281882
cycle= 3 E= -507.733820678836  delta_E= -2.73e-07  |g|= 0.000161  |ddm|= 0.000433
    CPU time for cycle= 3      0.01 sec, wall time      0.07 sec
diis-norm(errvec)=0.000217581
diis-c [-1.21286838e-09  2.45448141e-05 -3.22164518e-02  1.03219191e+00]
  HOMO = -0.236753220588775  LUMO = 59.1304999169334
  mo_energy =
[-1.20301938e+02 -1.22683666e+01 -6.65820062e+00 -6.65820062e+00
 -6.65820062e+00 -1.16431875e+00 -2.36753221e-01 -2.36753221e-01
 -2.36753221e-01  5.91304999e+01  4.35181692e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286801439244  E_coul = 198.89485946492684
cycle= 4 E= -507.733820678998  delta_E= -1.61e-10  |g|= 8.33e-07  |ddm|= 9.66e-06
    CPU time for cycle= 4      0.01 sec, wall time      0.01 sec
E1 = -706.6286801439244  E_coul = 198.89485946492684
  HOMO = -0.236753167157053  LUMO = 59.1305006015835
  mo_energy =
[-1.20301936e+02 -1.22683663e+01 -6.65820013e+00 -6.65820013e+00
 -6.65820013e+00 -1.16431873e+00 -2.36753167e-01 -2.36753167e-01
 -2.36753167e-01  5.91305006e+01  4.35181694e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286802684332  E_coul = 198.89485958943538
Extra cycle  E= -507.733820678998  delta_E= -2.84e-13  |g|= 1.68e-08  |ddm|= 5.99e-08
    CPU time for scf_cycle      5.53 sec, wall time      1.51 sec
exp = [5.88084071e+05 2.94042036e+05 1.47021018e+05 7.35105080e+04
 3.67552345e+04 7.33180217e+03 1.83771612e+04 1.23897777e+03
 2.98190016e+02 8.84304687e+01 3.06766812e+01 4.68345183e+00
 3.91016070e-01 8.59887875e+00 4.91051095e-01]
E = -507.7338206789978
#INFO: **** input file is /home/nike/basis-set-optimization/018_Ar/input.py ****
#!/usr/bin/env python

import pyscf
from pyscfad import gto, scf
import numpy as np
import re

from scipy import optimize

VERBOSITY = 9

def parse_basis_str(slug):
    numbers_and_letters = re.findall(r'[A-Za-z]+|\d+', slug)
    numbers_with_letters = [
        [int(numbers_and_letters[i]), numbers_and_letters[i+1].capitalize()]
        for i in range(0, len(numbers_and_letters), 2)
    ]
    return numbers_with_letters

def decaying_nums(n):
    return np.array([0.5 * (n - i) for i in range(n)])

def get_basis_substring(exponent, orbital):
    substring = f'''
    Ar  {orbital}
        {exponent}              1.0'''
    return substring

def get_basis_string(basis_str, exponents, exp_array=None):
    basis_set = parse_basis_str(basis_str)
    basis_nums = [num for [num, _] in basis_set]
    basis_cum_nums = np.cumsum(basis_nums)

    if exp_array is None:
        exp_array = np.zeros((exponents.size, 2))

    exp_array[np.where(exp_array[:, 1] == 0), 0] = exponents[np.where(exp_array[:, 1] == 0)]

    basis_string = ''.join([''.join([
        get_basis_substring(exp_array[i, 0], orbital) if j == 0 else
        get_basis_substring(exp_array[i + basis_cum_nums[j-1], 0], orbital)
        for i in range(num)
    ]) for j, [num, orbital] in enumerate(basis_set)])

    return basis_string

def atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}

    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    e = mf.kernel()

    print(f"exp = {exponents}")
    print(f"E = {e}")

    return e

def grad_atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}
    
    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    mf.kernel()
    jac = mf.energy_grad()

    print(f"exp = {exponents}")
    print(f"grad_E = {jac.exp}")

    grad_E = np.array(jac.exp)

    return grad_E

def minimize_energy(basis_str, exp_array=None):
    x0 = exp_array[:, 0]
    bnds = ((1e-9, None) for _ in range(exp_array.shape[0]))

    res = optimize.minimize(
        atomic_energy,
        x0,
        args=(basis_str, exp_array),
        method="SLSQP",
        jac=grad_atomic_energy,
        hess=None,
        hessp=None,
        bounds=bnds,
        tol=1e-9,
        callback=None,
        options={"maxfev": 10000, "ftol": 1e-9},
    )
    
    print(res)
    print(f"E = {atomic_energy(res.x, basis_str)}")
    print(f"exp = [{','.join(['{:.16e}'.format(x) for x in res.x])}]")
    
exps = np.zeros((15, 2))
#exps[:, 0] = decaying_nums(5)
exps_old = np.array([2.9404203565162310e+05,1.4702101782581155e+05,7.3510507976032939e+04,3.6755234472949749e+04,7.3318021734695621e+03,1.8377161218510078e+04,1.2389777727143498e+03,2.9819001594010280e+02,8.8430468748019706e+01,3.0676681173089506e+01,4.6834518331880934e+00,3.9101606979807535e-01,8.5988787479386612e+00,4.9105109461223539e-01])
exps[1:, 0] = exps_old[:]
exps[0, 0] = np.max(exps_old) * 2

basis = "13s2p"

minimize_energy(basis, exps)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='bc11219.int.ets1.calculquebec.ca', release='3.10.0-1160.76.1.el7.x86_64', version='#1 SMP Wed Aug 10 16:21:17 UTC 2022', machine='x86_64')  Threads 16
Python 3.10.2 (main, Feb  4 2022, 19:11:32) [GCC 9.3.0]
numpy 1.24.2  scipy 1.10.1
Date: Fri Mar 17 01:10:14 2023
PySCF version 2.1.1+ad
PySCF path  /localscratch/nike.35632132.0/ENV/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 16000
[ENV] PYSCF_CONFIG_FILE /home/nike/.pyscfad_conf.py
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 16000
[CONFIG] TMPDIR = /tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = /home/nike/.pyscfad_conf.py
[CONFIG] pyscf_numpy_backend = jax
[CONFIG] pyscf_scipy_backend = jax
[CONFIG] pyscf_scipy_linalg_backend = pyscfad
[CONFIG] pyscfad = True
[CONFIG] pyscfad_ccsd_implicit_diff = True
[CONFIG] pyscfad_scf_implicit_diff = True
[INPUT] verbose = 9
[INPUT] max_memory = 16000 
[INPUT] num. atoms = 1
[INPUT] num. electrons = 18
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ar     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Ar
[INPUT] 0    0    [1    /1   ]  588084.071303        1
[INPUT] 0    0    [1    /1   ]  294042.035652        1
[INPUT] 0    0    [1    /1   ]  147021.017826        1
[INPUT] 0    0    [1    /1   ]  73510.507976         1
[INPUT] 0    0    [1    /1   ]  36755.2344729        1
[INPUT] 0    0    [1    /1   ]  7331.80217347        1
[INPUT] 0    0    [1    /1   ]  18377.1612185        1
[INPUT] 0    0    [1    /1   ]  1238.97777271        1
[INPUT] 0    0    [1    /1   ]  298.19001594         1
[INPUT] 0    0    [1    /1   ]  88.430468748         1
[INPUT] 0    0    [1    /1   ]  30.6766811731        1
[INPUT] 0    0    [1    /1   ]  4.68345183319        1
[INPUT] 0    0    [1    /1   ]  0.391016069798       1
[INPUT] 1    0    [1    /1   ]  8.59887874794        1
[INPUT] 1    0    [1    /1   ]  0.491051094612       1

nuclear repulsion = 0
number of shells = 15
number of NR pGTOs = 19
number of NR cGTOs = 19
basis = {'Ar': [[0, [588084.0713032462, 1.0]], [0, [294042.0356516231, 1.0]], [0, [147021.01782581155, 1.0]], [0, [73510.50797603294, 1.0]], [0, [36755.23447294975, 1.0]], [0, [7331.802173469562, 1.0]], [0, [18377.16121851008, 1.0]], [0, [1238.9777727143498, 1.0]], [0, [298.1900159401028, 1.0]], [0, [88.4304687480197, 1.0]], [0, [30.676681173089506, 1.0]], [0, [4.683451833188093, 1.0]], [0, [0.39101606979807535, 1.0]], [1, [8.598878747938661, 1.0]], [1, [0.4910510946122354, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [588084.07130325]
bas 1, expnt(s) = [294042.03565162]
bas 2, expnt(s) = [147021.01782581]
bas 3, expnt(s) = [73510.50797603]
bas 4, expnt(s) = [36755.23447295]
bas 5, expnt(s) = [7331.80217347]
bas 6, expnt(s) = [18377.16121851]
bas 7, expnt(s) = [1238.97777271]
bas 8, expnt(s) = [298.19001594]
bas 9, expnt(s) = [88.43046875]
bas 10, expnt(s) = [30.67668117]
bas 11, expnt(s) = [4.68345183]
bas 12, expnt(s) = [0.39101607]
bas 13, expnt(s) = [8.59887875]
bas 14, expnt(s) = [0.49105109]
CPU time:         7.37
arg.atm = [[18 20  1 23  0  0]]
arg.bas = [[ 0  0  1  1  0 24 25  0]
 [ 0  0  1  1  0 26 27  0]
 [ 0  0  1  1  0 28 29  0]
 [ 0  0  1  1  0 30 31  0]
 [ 0  0  1  1  0 32 33  0]
 [ 0  0  1  1  0 34 35  0]
 [ 0  0  1  1  0 36 37  0]
 [ 0  0  1  1  0 38 39  0]
 [ 0  0  1  1  0 40 41  0]
 [ 0  0  1  1  0 42 43  0]
 [ 0  0  1  1  0 44 45  0]
 [ 0  0  1  1  0 46 47  0]
 [ 0  0  1  1  0 48 49  0]
 [ 0  1  1  1  0 50 51  0]
 [ 0  1  1  1  0 52 53  0]]
arg.env = [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.88084071e+05 5.36530712e+04 2.94042036e+05 3.19023070e+04
 1.47021018e+05 1.89692252e+04 7.35105080e+04 1.12791687e+04
 3.67552345e+04 6.70663116e+03 7.33180217e+03 2.00181103e+03
 1.83771612e+04 3.98771253e+03 1.23897777e+03 5.27609565e+02
 2.98190016e+02 1.81294591e+02 8.84304687e+01 7.28561923e+01
 3.06766812e+01 3.29322424e+01 4.68345183e+00 8.04339817e+00
 3.91016070e-01 1.24928343e+00 8.59887875e+00 4.29572700e+01
 4.91051095e-01 1.19920311e+00]
ecpbas  = []
Set gradient conv threshold to 3.16228e-05
Nelec from initial guess = 17.320919029160578
cond(S) = 8085.819100894392
E1 = -689.0217762222677  E_coul = 184.8934120398981
init E= -504.12836418237
    CPU time for initialize scf      4.30 sec, wall time      0.32 sec
  HOMO = -0.680411666686959  LUMO = 57.8459835850426
  mo_energy =
[-1.21689152e+02 -1.32943546e+01 -7.62443087e+00 -7.62443087e+00
 -7.62443087e+00 -1.64988997e+00 -6.80411667e-01 -6.80411667e-01
 -6.80411667e-01  5.78459836e+01  4.33806932e+02  2.20187382e+03
  1.13910197e+04  4.10589449e+04  1.10240452e+05  2.56003966e+05
  5.57112002e+05  1.19531066e+06  2.66496276e+06]
E1 = -706.6827735694505  E_coul = 198.94970356062234
cycle= 1 E= -507.733070008828  delta_E= -3.6  |g|= 0.345  |ddm|= 0.303
    CPU time for cycle= 1      0.14 sec, wall time      0.01 sec
diis-norm(errvec)=0.542049
diis-c [-0.2938173  1.       ]
  HOMO = -0.236412214763474  LUMO = 59.135270164721
  mo_energy =
[-1.20288229e+02 -1.22661114e+01 -6.65476107e+00 -6.65476107e+00
 -6.65476107e+00 -1.16419130e+00 -2.36412215e-01 -2.36412215e-01
 -2.36412215e-01  5.91352702e+01  4.35195860e+02  2.20319376e+03
  1.13922070e+04  4.10600578e+04  1.10241525e+05  2.56005012e+05
  5.57113027e+05  1.19531167e+06  2.66496375e+06]
E1 = -706.6296307546448  E_coul = 198.89581034849672
cycle= 2 E= -507.733820406148  delta_E= -0.00075  |g|= 0.00634  |ddm|= 0.0255
    CPU time for cycle= 2      0.07 sec, wall time      0.01 sec
diis-norm(errvec)=0.00682465
diis-c [-4.59051705e-05  1.50864360e-03  9.98491356e-01]
  HOMO = -0.236747296045644  LUMO = 59.1305894149306
  mo_energy =
[-1.20301681e+02 -1.22683255e+01 -6.65813297e+00 -6.65813297e+00
 -6.65813297e+00 -1.16431687e+00 -2.36747296e-01 -2.36747296e-01
 -2.36747296e-01  5.91305894e+01  4.35181941e+02  2.20317316e+03
  1.13921817e+04  4.10600309e+04  1.10241497e+05  2.56004984e+05
  5.57112999e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6287009607181  E_coul = 198.894880281882
cycle= 3 E= -507.733820678836  delta_E= -2.73e-07  |g|= 0.000161  |ddm|= 0.000433
    CPU time for cycle= 3      0.02 sec, wall time      0.01 sec
diis-norm(errvec)=0.000217581
diis-c [-1.21286838e-09  2.45448141e-05 -3.22164518e-02  1.03219191e+00]
  HOMO = -0.236753220588775  LUMO = 59.1304999169334
  mo_energy =
[-1.20301938e+02 -1.22683666e+01 -6.65820062e+00 -6.65820062e+00
 -6.65820062e+00 -1.16431875e+00 -2.36753221e-01 -2.36753221e-01
 -2.36753221e-01  5.91304999e+01  4.35181692e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286801439244  E_coul = 198.89485946492684
cycle= 4 E= -507.733820678998  delta_E= -1.61e-10  |g|= 8.33e-07  |ddm|= 9.66e-06
    CPU time for cycle= 4      0.01 sec, wall time      0.01 sec
E1 = -706.6286801439244  E_coul = 198.89485946492684
  HOMO = -0.236753167157053  LUMO = 59.1305006015835
  mo_energy =
[-1.20301936e+02 -1.22683663e+01 -6.65820013e+00 -6.65820013e+00
 -6.65820013e+00 -1.16431873e+00 -2.36753167e-01 -2.36753167e-01
 -2.36753167e-01  5.91305006e+01  4.35181694e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286802684332  E_coul = 198.89485958943538
Extra cycle  E= -507.733820678998  delta_E= -2.84e-13  |g|= 1.68e-08  |ddm|= 5.99e-08
    CPU time for scf_cycle      4.56 sec, wall time      0.38 sec
Set gradient conv threshold to 3.16228e-05
cond(S) = 8085.819100894392
E1 = -706.6286802684332  E_coul = 198.89485958943538
init E= -507.733820678998
    CPU time for initialize scf      7.29 sec, wall time      0.61 sec
  HOMO = -0.236753166383869  LUMO = 59.1305006124298
  mo_energy =
[-1.20301936e+02 -1.22683663e+01 -6.65820012e+00 -6.65820012e+00
 -6.65820012e+00 -1.16431873e+00 -2.36753166e-01 -2.36753166e-01
 -2.36753166e-01  5.91305006e+01  4.35181694e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.628680270741  E_coul = 198.89485959174317
cycle= 1 E= -507.733820678998  delta_E= -5.68e-14  |g|= 3.98e-10  |ddm|= 1.07e-09
    CPU time for cycle= 1      0.14 sec, wall time      0.01 sec
E1 = -706.628680270741  E_coul = 198.89485959174317
  HOMO = -0.23675316637109  LUMO = 59.130500612627
  mo_energy =
[-1.20301936e+02 -1.22683663e+01 -6.65820012e+00 -6.65820012e+00
 -6.65820012e+00 -1.16431873e+00 -2.36753166e-01 -2.36753166e-01
 -2.36753166e-01  5.91305006e+01  4.35181694e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286802707888  E_coul = 198.8948595917912
Extra cycle  E= -507.733820678998  delta_E= 2.84e-13  |g|= 4.72e-11  |ddm|= 2.23e-11
    CPU time for scf_cycle      8.40 sec, wall time      1.58 sec
exp = [5.88084071e+05 2.94042036e+05 1.47021018e+05 7.35105080e+04
 3.67552345e+04 7.33180217e+03 1.83771612e+04 1.23897777e+03
 2.98190016e+02 8.84304687e+01 3.06766812e+01 4.68345183e+00
 3.91016070e-01 8.59887875e+00 4.91051095e-01]
grad_E = [ 3.80621180e-10  1.39564846e-09  8.17380929e-09  2.71076979e-08
  1.64705686e-07  9.02793612e-06  4.08896527e-07  3.62783045e-06
 -3.62795033e-06  1.14881442e-05 -9.41862795e-06 -1.08848619e-05
 -1.19004085e-05  6.69372255e-07  1.15138522e-06]
 message: Optimization terminated successfully
 success: True
  status: 0
     fun: -507.7338206789978
       x: [ 5.881e+05  2.940e+05 ...  8.599e+00  4.911e-01]
     nit: 1
     jac: [ 3.806e-10  1.396e-09 ...  6.694e-07  1.151e-06]
    nfev: 1
    njev: 1
#INFO: **** input file is /home/nike/basis-set-optimization/018_Ar/input.py ****
#!/usr/bin/env python

import pyscf
from pyscfad import gto, scf
import numpy as np
import re

from scipy import optimize

VERBOSITY = 9

def parse_basis_str(slug):
    numbers_and_letters = re.findall(r'[A-Za-z]+|\d+', slug)
    numbers_with_letters = [
        [int(numbers_and_letters[i]), numbers_and_letters[i+1].capitalize()]
        for i in range(0, len(numbers_and_letters), 2)
    ]
    return numbers_with_letters

def decaying_nums(n):
    return np.array([0.5 * (n - i) for i in range(n)])

def get_basis_substring(exponent, orbital):
    substring = f'''
    Ar  {orbital}
        {exponent}              1.0'''
    return substring

def get_basis_string(basis_str, exponents, exp_array=None):
    basis_set = parse_basis_str(basis_str)
    basis_nums = [num for [num, _] in basis_set]
    basis_cum_nums = np.cumsum(basis_nums)

    if exp_array is None:
        exp_array = np.zeros((exponents.size, 2))

    exp_array[np.where(exp_array[:, 1] == 0), 0] = exponents[np.where(exp_array[:, 1] == 0)]

    basis_string = ''.join([''.join([
        get_basis_substring(exp_array[i, 0], orbital) if j == 0 else
        get_basis_substring(exp_array[i + basis_cum_nums[j-1], 0], orbital)
        for i in range(num)
    ]) for j, [num, orbital] in enumerate(basis_set)])

    return basis_string

def atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}

    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    e = mf.kernel()

    print(f"exp = {exponents}")
    print(f"E = {e}")

    return e

def grad_atomic_energy(exponents, basis_str, exp_array=None):
    mol = gto.Mole()
    mol.atom = 'Ar 0 0 0'  # in Angstrom

    basis_string = get_basis_string(basis_str, exponents, exp_array)
    mol.basis = {'Ar': pyscf.gto.basis.parse(basis_string)}
    
    mol.verbose = VERBOSITY
    mol.build()

    mf = scf.RHF(mol)
    mf.kernel()
    jac = mf.energy_grad()

    print(f"exp = {exponents}")
    print(f"grad_E = {jac.exp}")

    grad_E = np.array(jac.exp)

    return grad_E

def minimize_energy(basis_str, exp_array=None):
    x0 = exp_array[:, 0]
    bnds = ((1e-9, None) for _ in range(exp_array.shape[0]))

    res = optimize.minimize(
        atomic_energy,
        x0,
        args=(basis_str, exp_array),
        method="SLSQP",
        jac=grad_atomic_energy,
        hess=None,
        hessp=None,
        bounds=bnds,
        tol=1e-9,
        callback=None,
        options={"maxfev": 10000, "ftol": 1e-9},
    )
    
    print(res)
    print(f"E = {atomic_energy(res.x, basis_str)}")
    print(f"exp = [{','.join(['{:.16e}'.format(x) for x in res.x])}]")
    
exps = np.zeros((15, 2))
#exps[:, 0] = decaying_nums(5)
exps_old = np.array([2.9404203565162310e+05,1.4702101782581155e+05,7.3510507976032939e+04,3.6755234472949749e+04,7.3318021734695621e+03,1.8377161218510078e+04,1.2389777727143498e+03,2.9819001594010280e+02,8.8430468748019706e+01,3.0676681173089506e+01,4.6834518331880934e+00,3.9101606979807535e-01,8.5988787479386612e+00,4.9105109461223539e-01])
exps[1:, 0] = exps_old[:]
exps[0, 0] = np.max(exps_old) * 2

basis = "13s2p"

minimize_energy(basis, exps)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='bc11219.int.ets1.calculquebec.ca', release='3.10.0-1160.76.1.el7.x86_64', version='#1 SMP Wed Aug 10 16:21:17 UTC 2022', machine='x86_64')  Threads 16
Python 3.10.2 (main, Feb  4 2022, 19:11:32) [GCC 9.3.0]
numpy 1.24.2  scipy 1.10.1
Date: Fri Mar 17 01:10:21 2023
PySCF version 2.1.1+ad
PySCF path  /localscratch/nike.35632132.0/ENV/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 16000
[ENV] PYSCF_CONFIG_FILE /home/nike/.pyscfad_conf.py
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 16000
[CONFIG] TMPDIR = /tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = /home/nike/.pyscfad_conf.py
[CONFIG] pyscf_numpy_backend = jax
[CONFIG] pyscf_scipy_backend = jax
[CONFIG] pyscf_scipy_linalg_backend = pyscfad
[CONFIG] pyscfad = True
[CONFIG] pyscfad_ccsd_implicit_diff = True
[CONFIG] pyscfad_scf_implicit_diff = True
[INPUT] verbose = 9
[INPUT] max_memory = 16000 
[INPUT] num. atoms = 1
[INPUT] num. electrons = 18
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ar     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Ar
[INPUT] 0    0    [1    /1   ]  588084.071303        1
[INPUT] 0    0    [1    /1   ]  294042.035652        1
[INPUT] 0    0    [1    /1   ]  147021.017826        1
[INPUT] 0    0    [1    /1   ]  73510.507976         1
[INPUT] 0    0    [1    /1   ]  36755.2344729        1
[INPUT] 0    0    [1    /1   ]  7331.80217347        1
[INPUT] 0    0    [1    /1   ]  18377.1612185        1
[INPUT] 0    0    [1    /1   ]  1238.97777271        1
[INPUT] 0    0    [1    /1   ]  298.19001594         1
[INPUT] 0    0    [1    /1   ]  88.430468748         1
[INPUT] 0    0    [1    /1   ]  30.6766811731        1
[INPUT] 0    0    [1    /1   ]  4.68345183319        1
[INPUT] 0    0    [1    /1   ]  0.391016069798       1
[INPUT] 1    0    [1    /1   ]  8.59887874794        1
[INPUT] 1    0    [1    /1   ]  0.491051094612       1

nuclear repulsion = 0
number of shells = 15
number of NR pGTOs = 19
number of NR cGTOs = 19
basis = {'Ar': [[0, [588084.0713032462, 1.0]], [0, [294042.0356516231, 1.0]], [0, [147021.01782581155, 1.0]], [0, [73510.50797603294, 1.0]], [0, [36755.23447294975, 1.0]], [0, [7331.802173469562, 1.0]], [0, [18377.16121851008, 1.0]], [0, [1238.9777727143498, 1.0]], [0, [298.1900159401028, 1.0]], [0, [88.4304687480197, 1.0]], [0, [30.676681173089506, 1.0]], [0, [4.683451833188093, 1.0]], [0, [0.39101606979807535, 1.0]], [1, [8.598878747938661, 1.0]], [1, [0.4910510946122354, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [588084.07130325]
bas 1, expnt(s) = [294042.03565162]
bas 2, expnt(s) = [147021.01782581]
bas 3, expnt(s) = [73510.50797603]
bas 4, expnt(s) = [36755.23447295]
bas 5, expnt(s) = [7331.80217347]
bas 6, expnt(s) = [18377.16121851]
bas 7, expnt(s) = [1238.97777271]
bas 8, expnt(s) = [298.19001594]
bas 9, expnt(s) = [88.43046875]
bas 10, expnt(s) = [30.67668117]
bas 11, expnt(s) = [4.68345183]
bas 12, expnt(s) = [0.39101607]
bas 13, expnt(s) = [8.59887875]
bas 14, expnt(s) = [0.49105109]
CPU time:        25.67
arg.atm = [[18 20  1 23  0  0]]
arg.bas = [[ 0  0  1  1  0 24 25  0]
 [ 0  0  1  1  0 26 27  0]
 [ 0  0  1  1  0 28 29  0]
 [ 0  0  1  1  0 30 31  0]
 [ 0  0  1  1  0 32 33  0]
 [ 0  0  1  1  0 34 35  0]
 [ 0  0  1  1  0 36 37  0]
 [ 0  0  1  1  0 38 39  0]
 [ 0  0  1  1  0 40 41  0]
 [ 0  0  1  1  0 42 43  0]
 [ 0  0  1  1  0 44 45  0]
 [ 0  0  1  1  0 46 47  0]
 [ 0  0  1  1  0 48 49  0]
 [ 0  1  1  1  0 50 51  0]
 [ 0  1  1  1  0 52 53  0]]
arg.env = [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.88084071e+05 5.36530712e+04 2.94042036e+05 3.19023070e+04
 1.47021018e+05 1.89692252e+04 7.35105080e+04 1.12791687e+04
 3.67552345e+04 6.70663116e+03 7.33180217e+03 2.00181103e+03
 1.83771612e+04 3.98771253e+03 1.23897777e+03 5.27609565e+02
 2.98190016e+02 1.81294591e+02 8.84304687e+01 7.28561923e+01
 3.06766812e+01 3.29322424e+01 4.68345183e+00 8.04339817e+00
 3.91016070e-01 1.24928343e+00 8.59887875e+00 4.29572700e+01
 4.91051095e-01 1.19920311e+00]
ecpbas  = []
Set gradient conv threshold to 3.16228e-05
Nelec from initial guess = 17.320919029160578
cond(S) = 8085.819100894392
E1 = -689.0217762222677  E_coul = 184.8934120398981
init E= -504.12836418237
    CPU time for initialize scf      4.78 sec, wall time      0.34 sec
  HOMO = -0.680411666686959  LUMO = 57.8459835850426
  mo_energy =
[-1.21689152e+02 -1.32943546e+01 -7.62443087e+00 -7.62443087e+00
 -7.62443087e+00 -1.64988997e+00 -6.80411667e-01 -6.80411667e-01
 -6.80411667e-01  5.78459836e+01  4.33806932e+02  2.20187382e+03
  1.13910197e+04  4.10589449e+04  1.10240452e+05  2.56003966e+05
  5.57112002e+05  1.19531066e+06  2.66496276e+06]
E1 = -706.6827735694505  E_coul = 198.94970356062234
cycle= 1 E= -507.733070008828  delta_E= -3.6  |g|= 0.345  |ddm|= 0.303
    CPU time for cycle= 1      0.17 sec, wall time      0.01 sec
diis-norm(errvec)=0.542049
diis-c [-0.2938173  1.       ]
  HOMO = -0.236412214763474  LUMO = 59.135270164721
  mo_energy =
[-1.20288229e+02 -1.22661114e+01 -6.65476107e+00 -6.65476107e+00
 -6.65476107e+00 -1.16419130e+00 -2.36412215e-01 -2.36412215e-01
 -2.36412215e-01  5.91352702e+01  4.35195860e+02  2.20319376e+03
  1.13922070e+04  4.10600578e+04  1.10241525e+05  2.56005012e+05
  5.57113027e+05  1.19531167e+06  2.66496375e+06]
E1 = -706.6296307546448  E_coul = 198.89581034849672
cycle= 2 E= -507.733820406148  delta_E= -0.00075  |g|= 0.00634  |ddm|= 0.0255
    CPU time for cycle= 2      0.04 sec, wall time      0.01 sec
diis-norm(errvec)=0.00682465
diis-c [-4.59051705e-05  1.50864360e-03  9.98491356e-01]
  HOMO = -0.236747296045644  LUMO = 59.1305894149306
  mo_energy =
[-1.20301681e+02 -1.22683255e+01 -6.65813297e+00 -6.65813297e+00
 -6.65813297e+00 -1.16431687e+00 -2.36747296e-01 -2.36747296e-01
 -2.36747296e-01  5.91305894e+01  4.35181941e+02  2.20317316e+03
  1.13921817e+04  4.10600309e+04  1.10241497e+05  2.56004984e+05
  5.57112999e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6287009607181  E_coul = 198.894880281882
cycle= 3 E= -507.733820678836  delta_E= -2.73e-07  |g|= 0.000161  |ddm|= 0.000433
    CPU time for cycle= 3      0.01 sec, wall time      0.01 sec
diis-norm(errvec)=0.000217581
diis-c [-1.21286838e-09  2.45448141e-05 -3.22164518e-02  1.03219191e+00]
  HOMO = -0.236753220588775  LUMO = 59.1304999169334
  mo_energy =
[-1.20301938e+02 -1.22683666e+01 -6.65820062e+00 -6.65820062e+00
 -6.65820062e+00 -1.16431875e+00 -2.36753221e-01 -2.36753221e-01
 -2.36753221e-01  5.91304999e+01  4.35181692e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286801439244  E_coul = 198.89485946492684
cycle= 4 E= -507.733820678998  delta_E= -1.61e-10  |g|= 8.33e-07  |ddm|= 9.66e-06
    CPU time for cycle= 4      0.01 sec, wall time      0.01 sec
E1 = -706.6286801439244  E_coul = 198.89485946492684
  HOMO = -0.236753167157053  LUMO = 59.1305006015835
  mo_energy =
[-1.20301936e+02 -1.22683663e+01 -6.65820013e+00 -6.65820013e+00
 -6.65820013e+00 -1.16431873e+00 -2.36753167e-01 -2.36753167e-01
 -2.36753167e-01  5.91305006e+01  4.35181694e+02  2.20317284e+03
  1.13921813e+04  4.10600305e+04  1.10241497e+05  2.56004983e+05
  5.57112998e+05  1.19531164e+06  2.66496373e+06]
E1 = -706.6286802684332  E_coul = 198.89485958943538
Extra cycle  E= -507.733820678998  delta_E= -2.84e-13  |g|= 1.68e-08  |ddm|= 5.99e-08
    CPU time for scf_cycle      5.02 sec, wall time      0.40 sec
exp = [5.88084071e+05 2.94042036e+05 1.47021018e+05 7.35105080e+04
 3.67552345e+04 7.33180217e+03 1.83771612e+04 1.23897777e+03
 2.98190016e+02 8.84304687e+01 3.06766812e+01 4.68345183e+00
 3.91016070e-01 8.59887875e+00 4.91051095e-01]
E = -507.7338206789978
E = -507.7338206789978
exp = [5.8808407130324619e+05,2.9404203565162310e+05,1.4702101782581155e+05,7.3510507976032939e+04,3.6755234472949749e+04,7.3318021734695621e+03,1.8377161218510078e+04,1.2389777727143498e+03,2.9819001594010280e+02,8.8430468748019706e+01,3.0676681173089506e+01,4.6834518331880934e+00,3.9101606979807535e-01,8.5988787479386612e+00,4.9105109461223539e-01]
